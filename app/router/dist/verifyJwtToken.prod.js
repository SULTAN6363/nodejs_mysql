"use strict";var jwt=require("jsonwebtoken"),config=require("../config/config.js"),db=require("../config/db.config.js"),Role=db.role,User=db.user;verifyToken=function(n,t,r){var e=n.headers["x-access-token"];if(!e)return t.status(403).send({status:!1,message:"Geçersiz token..."});jwt.verify(e,config.secret,function(e,s){if(e)return t.status(500).send({status:!1,message:"İşlem başarısız. Hata -> "+e});n.userId=s.id,r()})},isAdmin=function(s,n,t){s.headers["x-access-token"];console.log(s.userId),User.findByPk(s.userId).then(function(e){console.log(s.userId),e.getRoles().then(function(e){for(var s=0;s<e.length;s++)if(console.log(e[s].name),"ADMIN"===e[s].name.toUpperCase())return console.log(e[s].name),void t();return n.status(403).send("Admin rolü gerekli!")})})};var authJwt={};authJwt.verifyToken=verifyToken,authJwt.isAdmin=isAdmin,module.exports=authJwt;